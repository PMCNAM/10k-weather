function formatCurrentWx(a){var b={};b=200!=a.cod?{cod:a.cod}:{cod:a.cod,temp:a.main.temp,humidity:a.main.humidity,pressure:a.main.pressure,temp_max:a.main.temp_max,temp_min:a.main.temp_min,wind_deg:a.wind.deg,wind_speed:a.wind.speed,name:a.name,conditions:a.weather[0].main,icon:a.weather[0].icon},jsPost("format-weather.php",toQueryString(b),showWx)}function toQueryString(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}function showWx(a){document.querySelector(".wx-container").innerHTML=a}function jsPost(a,b,c){var d=new XMLHttpRequest;d.open("POST",a,!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.onreadystatechange=function(){4==d.readyState&&200==d.status&&c(d.responseText)},d.send(b)}function jsGet(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onload=function(){if(4==c.readyState&&c.status>=200&&c.status<500){var a=JSON.parse(c.responseText);return b(a)}},c.onerror=function(){},c.send()}function submitForm(a){a.preventDefault();var b=document.getElementById("location-input"),c=b.value.split(",")[0],d="http://api.openweathermap.org/data/2.5/weather?q="+c+"&APPID="+wxAppId;""==b.value||0==/^[a-zA-Z, ]*$/.test(b.value)?b.classList.add("error"):(b.classList=b.className.replace("error",""),updateUrl(c),jsGet(d,formatCurrentWx))}function updateUrl(a){if(history.pushState){var b=window.location.protocol+"//"+window.location.host+window.location.pathname+"?city="+a;window.history.pushState({path:b},"",b)}}var wxAppId = "3XAMPLK3YW1THL3TT3RSANDNUMB3RS";document.querySelector(".location-submit").addEventListener("click",submitForm);